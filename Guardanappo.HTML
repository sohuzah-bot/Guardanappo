<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Pedidos de M√∫sica</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 p-4">

  <div class="max-w-xl mx-auto">
    <h1 class="text-2xl font-bold mb-4 text-center">üéß Fa√ßa seu pedido musical</h1>

    <!-- Campo de busca -->
    <input type="text" id="busca" placeholder="Buscar por nome, artista ou g√™nero"
      class="w-full p-2 mb-2 border rounded" oninput="filtrarMusicas()">

    <!-- Filtro por g√™nero -->
    <select id="filtroGenero" class="w-full p-2 mb-4 border rounded" onchange="filtrarMusicas()">
      <option value="">Todos os g√™neros</option>
      <option value="Pop">Pop</option>
      <option value="Rock">Rock</option>
      <option value="Sertanejo">Sertanejo</option>
      <option value="Bossa Nova">Bossa Nova</option>
    </select>

    <!-- Lista de m√∫sicas -->
    <div id="lista-musicas" class="space-y-4"></div>
  </div>

  <script>
    let musicas = [];

    // Simula√ß√£o de carregamento via Google Sheets
    async function carregarMusicas() {
      try {
        const response = await fetch("https://script.google.com/macros/s/SEU_SCRIPT_ID/exec");
        const data = await response.json();
        musicas = data.musicas;
        filtrarMusicas();
      } catch (error) {
        document.getElementById("lista-musicas").innerHTML = "<p class='text-red-500'>Erro ao carregar m√∫sicas.</p>";
      }
    }

    function filtrarMusicas() {
      const termo = document.getElementById("busca").value.toLowerCase();
      const genero = document.getElementById("filtroGenero").value;
      const lista = document.getElementById("lista-musicas");
      lista.innerHTML = "";

      const filtradas = musicas.filter(m =>
        (m.nome.toLowerCase().includes(termo) ||
         m.artista.toLowerCase().includes(termo) ||
         m.genero.toLowerCase().includes(termo)) &&
        (genero === "" || m.genero === genero)
      );

      if (filtradas.length === 0) {
        lista.innerHTML = "<p class='text-gray-500'>Nenhuma m√∫sica encontrada.</p>";
        return;
      }

      filtradas.forEach(m => {
        const div = document.createElement("div");
        div.className = "bg-white p-4 rounded shadow";
        div.innerHTML = `
          <h3 class="text-lg font-bold">${m.nome}</h3>
          <p class="text-sm text-gray-600">${m.artista} ‚Ä¢ ${m.genero}</p>
          <button onclick="enviarPedido('${m.nome}', '${m.artista}', '${m.genero}')"
            class="mt-2 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Pedir</button>
        `;
        lista.appendChild(div);
      });
    }

    function enviarPedido(nome, artista, genero) {
      const cliente = prompt("Digite seu nome:");
      if (!cliente) return;

      const itens = `${nome} - ${artista}`;
      const total = 5.00;

      fetch("https://script.google.com/macros/s/SEU_SCRIPT_ID/exec", {
        method: "POST",
        body: JSON.stringify({ cliente, itens, total })
      })
      .then(res => res.text())
      .then(msg => alert(msg))
      .catch(() => alert("Erro ao enviar pedido."));
    }

    carregarMusicas();
  </script>

</body>
</html>
